@page "/dashboard"
@inject AuthService AuthService
@inject NavigationManager Navigation
@attribute [Microsoft.AspNetCore.Authorization.Authorize]

<PageTitle>Dashboard - ResumeCloud</PageTitle>

<div class="dashboard-page">
    <div class="dashboard-header">
        <h1>Welcome back, @(AuthService.CurrentUser?.Name ?? "User")!</h1>
        <p>What would you like to do today?</p>
    </div>

    <div class="dashboard-actions">
        <div class="action-card" @onclick='() => Navigation.NavigateTo("/templates")'>
            <div class="action-icon icon-blue">
                @* Plus Icon *@
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            </div>
            <h3>Create New Resume</h3>
            <p>Start with a professional template</p>
        </div>

        <div class="action-card" @onclick='() => Navigation.NavigateTo("/my-resumes")'>
            <div class="action-icon icon-green">
                @* File Text Icon *@
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
            </div>
            <h3>My Resumes</h3>
            <p>View and edit your saved resumes</p>
        </div>

        <div class="action-card" @onclick='() => Navigation.NavigateTo("/templates")'>
            <div class="action-icon icon-purple">
                @* Layout Icon *@
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
            </div>
            <h3>Browse Templates</h3>
            <p>Explore all available templates</p>
        </div>
    </div>

    <div class="quick-stats">
        <div class="stat-card">
            <div class="stat-number">0</div>
            <div class="stat-label">Total Resumes</div>
        </div>

        <div class="stat-card">
            <div class="stat-number">4</div>
            <div class="stat-label">Templates Available</div>
        </div>

        <div class="stat-card">
            <div class="stat-number">0</div>
            <div class="stat-label">Downloads</div>
        </div>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        // 1. We must await the initialization to ensure the token is
        // loaded from SessionStorage before we check it.
        await AuthService.InitializeAsync();

        Console.WriteLine("tokeb = " + AuthService.AuthToken);
        // 2. Check if the Token string is null or empty
        if (string.IsNullOrEmpty(AuthService.AuthToken))
        {
            Navigation.NavigateTo("/");
        }
    }
}

<style>
    /* Dashboard Specific Styles */
    .dashboard-page {
        max-width: 1200px;
        margin: 0 auto;
    }

    .dashboard-header {
        margin-bottom: 2.5rem;
    }

        .dashboard-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 0.5rem;
        }

        .dashboard-header p {
            color: #6b7280;
            font-size: 1.1rem;
        }

    /* Action Cards */
    .dashboard-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 3rem;
    }

    .action-card {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 16px;
        padding: 2rem;
        transition: all 0.2s ease;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        height: 100%;
    }

        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -10px rgba(0, 0, 0, 0.1);
            border-color: #d1d5db;
        }

    .action-icon {
        width: 64px;
        height: 64px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1.5rem;
    }

    /* Icon Variants */
    .icon-blue {
        background-color: #eff6ff;
        color: #2563EB;
    }

    .icon-green {
        background-color: #f0fdf4;
        color: #16a34a;
    }

    .icon-purple {
        background-color: #faf5ff;
        color: #9333ea;
    }

    .action-card h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: #111827;
        margin: 0 0 0.5rem 0;
    }

    .action-card p {
        color: #6b7280;
        margin: 0;
        line-height: 1.5;
    }

    /* Stats Section */
    .quick-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
    }

    .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        text-align: center;
    }

    .stat-number {
        font-size: 2rem;
        font-weight: 800;
        color: #111827;
        margin-bottom: 0.25rem;
    }

    .stat-label {
        color: #6b7280;
        font-size: 0.9rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
</style>